# 5 评估参数

## **2025-01-06**评估参数EvaluatePara

### temprature

double t_DeltaR    ;

解释：总温度，应该控制在实验室温度300k左右（摄氏27度），或者生物体温度308k左右（摄氏35度）

double t_DeltaRElcCol;

解释：由ElcCol计算产生的温度。

double t_DeltaRCouVdw;

解释：由CouVdw计算产生的温度。

### Bond

double LimitDeviationLevel_Bond;

解释：前面提到条件公式：“最大偏移量”>“极限偏移量”>“最小偏移量”，每个振子的“极限偏移量”是不断变化的，为了综合掌握这个信息，计算一个实时评估参数“极限偏移量平均水平LimitDeviationLevel_Bond”，将所有的Bond振子的“极限偏移量”在最大最小值之间的平均位置统计一下。

double Mode_1_Level_Bond;

解释：所有的Bond振子中，执行“强制回位操作”的统计比例。每一步的振子位移计算方法分为两种：“强制回位操作”和“一般震荡操作”。

double Max_ratio_terminal_Bond;

int   Max_ratio_terminal_Bond_idx;

double Min_ratio_terminal_Bond;

int   Min_ratio_terminal_Bond_idx;

解释：对于每一个Bond振子，完成一步计算后，其当前的实际状态（两原子距离）与平衡位置（固定值，来源于统计）的比值，记为ratio_terminal_Bond，然后统计所有的Bond振子，找到最大的（Max_ratio_terminal_Bond），并记下其Bond振子编号（Max_ratio_terminal_Bond_idx），找到最小的（Min_ratio_terminal_Bond），也记下其Bond振子编号（Min_ratio_terminal_Bond_idx），

### Angle

double LimitDeviationLevel_Angle;

double Mode_1_Level_Angle;

double Max_ratio_terminal_Angle;

int   Max_ratio_terminal_Angle_idx;

double Min_ratio_terminal_Angle;

int   Min_ratio_terminal_Angle_idx;

解释：类似Bond

### Plane

double LimitDeviationLevel_Plane;

double Mode_1_Level_Plane;

double Max_ratio_terminal_Plane;

int   Max_ratio_terminal_Plane_idx;

double Min_ratio_terminal_Plane;

int   Min_ratio_terminal_Plane_idx;

解释：类似Bond

### ElcCol

int Num_elccol_move_ALL ;

int Num_elccol_move_NONE;

int Num_elccol_move_COL1;

int Num_elccol_move_COL2;

int Num_elccol_move_ELC ;

int Num_elccol_move_OTHE;

解释：ElcCol三种操作（COL1、COL2、ELC）的数量统计

### Dihedral

int Num_Dihedral_ALL;

int Num_valley_change ;

解释：“dihedral**相变”**的数量统计

## **2025-01-09**结果输出

**当前运行数据，每一步运算后，都可以输出到四个列表，**

DvnnForceBondList  * dvnnBondList  

DvnnForceAngleList  * dvnnAngleList  

DvnnForceDihedralList* dvnnDihedralList

DvnnForcePlaneList  * dvnnPlaneList  



// copy current data

qomd_shell3_copy_current_from_proteinBag_dvnnBondList(dvnnBondList, (void*) proteinBag_1VII);

qomd_shell3_copy_current_from_proteinBag_dvnnAngleList(dvnnAngleList, (void*) proteinBag_1VII);

qomd_shell3_copy_current_from_proteinBag_dvnnDihedralList(dvnnDihedralList, (void*) proteinBag_1VII);

qomd_shell3_copy_current_from_proteinBag_dvnnPlaneList(dvnnPlaneList, (void*) proteinBag_1VII);

 

 

**数据结构解释：**

### DvnnRecord

```C
struct DvnnRecord{
// 此数据结构用于记录当前振子（适用于bond,angle,plane）的数据
int   Mode;      

// 0 ; 初始值init

// 1 : 强制拉回computeHarmonic_get_normal_delta_d_regressive_enforce_constraint

// 2 : 一般震荡computeHarmonic_get_normal_delta_d_syntonic

Mode记录当前振子的操作模式，

 

以下四个值为振子的状态变化值，嵌入到三种数据结构情况：

（bond：两原子间距，单位，埃10-10米）

（angle：三原子夹角，单位，弧度角）

（plane：星型四原子平面角度，单位，弧度角）

 

一个计算步骤，每个振子的状态变化由两种因素构成，

1来自于振子内部的弹性震荡，（强制拉回和一般震荡）

2来自于振子外部的相互作用，（各个振子之间的力作用）

 

double Start  ; // 开始值
double Target  ; // 内部目标值，内部的弹性震荡的计算预测值
double Arrive  ; // 内部实际达到值，内部的弹性震荡的实际计算值
double Terminal; // 最终状态值，外部扰动效果叠加后的最终值
};
```

 

```bash
struct DvnnForceBond {

//////  links   

int VertexI;        // 原子编号array index of VertexI, index of the data in List of DvnnAtomicVertexList

int VertexJ;        // 原子编号array index of VertexJ, index of the data in List of DvnnAtomicVertexList

 

//////  fixed parameters

double req;        // 两原子距离的平衡值r_equilibrium, bottom of the valley

double qomdFreq;      // 旧频谱数据frequency : wave number (1/cm), 2024-10-02

double hhmoFreq;      // 新频谱数据frequency : wave number (1/cm), 2024-10-02

 

//////  fixed parameters

double MaxDeviation;    // 最大偏移量add 2025-01-08, maximum deviation, fixed para

double MinDeviation;    // 最小偏移量add 2025-01-08, minimum deviation, fixed para

 

//////  variant parameters

double LimitDeviation;   // 极限偏移量add 2025-01-08, current deviation, variant para

 

“最大偏移量”和“最小偏移量”初始设定后不变。

前面提到的满足条件：“最大偏移量”>“极限偏移量”>“最小偏移量”

每个振子的“极限偏移量”在最大和最小之间不断变化的，表示该振子的能量变化。

 

//////  variant parameters

DvnnRecord Record;     // 解释在前面

 

};
```

 

 

 

```bash
struct DvnnForceAngle {

这里的解释类似于bond

//////  links   

int VertexI;        // array index of VertexI, index of the data in List of DvnnAtomicVertexList

int VertexJ;        // array index of VertexJ, index of the data in List of DvnnAtomicVertexList, center point

int VertexK;        // array index of VertexK, index of the data in List of DvnnAtomicVertexList

  

//////  parameters

double thetaeq;      // 三原子夹角平衡值，注意这里单位是角度theta_equilibrium, bottom of the valley, Degree

double qomdFreq;      // frequency : wave number (1/cm), 2024-10-02

double hhmoFreq;      // frequency : wave number (1/cm), 2024-10-02

 

//////  fixed parameters

double MaxDeviation;    // add 2025-01-08, maximum deviation, fixed para

double MinDeviation;    // add 2025-01-08, minimum deviation, fixed para

 

//////  variant parameters

double LimitDeviation;   // add 2025-01-08, current deviation, variant para

 

//////  variant parameters

DvnnRecord Record;     // 注意这里单位是弧度

 

};
```

 

 

 

```bash
struct DvnnForceDihedral {

这里的解释类似于bond

 

//////  links   

int VertexI;        // array index of VertexI, index of the data in List of DvnnAtomicVertexList

int VertexJ;        // array index of VertexJ, index of the data in List of DvnnAtomicVertexList

int VertexK;        // array index of VertexK, index of the data in List of DvnnAtomicVertexList

int VertexL;        // array index of VertexL, index of the data in List of DvnnAtomicVertexList

  

//////  parameters

double qomdFreq;      // frequency : wave number (1/cm), 2024-10-02

double hhmoFreq;      // frequency : wave number (1/cm), 2024-10-02

 

//////  variant parameters

DvnnRecordDihedral Record;     // add 2025-01-08, current deviation, variant para

 

};
```

 

```bash
struct DvnnRecordDihedral{

这专门用于dihedral的数据记录

 

对于二面角结构，实际上是0~360度旋转，形成两个或者三个Valley（波峰波谷结构），从一个Valley变化到另一个Valley，既完成一次角度相变，这个相变是蛋白质构象变化的关键。



 

Start  ; // 开始值

Target  ; // 内部目标值，内部的弹性震荡的计算预测值

Arrive  ; // 内部实际达到值，内部的弹性震荡的实际计算值

Terminal; // 最终状态值，外部扰动效果叠加后的最终值

 

int ValleyStart  ; Valley编号值

int ValleyTarget  ;

int ValleyArrive  ;

int ValleyTerminal;

 

double PhiStart  ;  Phi二面角值（注意这里单位是弧度）

double PhiTarget  ; 

double PhiArrive  ; 

double PhiTerminal; 

};
```

 

 

```bash
struct DvnnForcePlane {

这里的解释类似于bond

 

//////  links   

int VertexI;        // array index of VertexI, index of the data in List of DvnnAtomicVertexList

int VertexJ;        // array index of VertexJ, index of the data in List of DvnnAtomicVertexList

int VertexK;        // array index of VertexK, index of the data in List of DvnnAtomicVertexList

int VertexL;        // array index of VertexL, index of the data in List of DvnnAtomicVertexList

  

//////  parameters

double phieq;       // 星型四原子平面角度平衡值，注意这里单位是角度（并且固定180度）phi_equilibrium, same as gamma2 in GvnnForcePlane;          

​               // Degree : Gamma2 is equal to 180 DEG always.

 

double qomdFreq;      // frequency : wave number (1/cm), 2024-10-02

double hhmoFreq;      // frequency : wave number (1/cm), 2024-10-02

 

//////  fixed parameters

double MaxDeviation;    // add 2025-01-08, maximum deviation, fixed para

double MinDeviation;    // add 2025-01-08, minimum deviation, fixed para

 

//////  variant parameters

double LimitDeviation;   // add 2025-01-08, current deviation, variant para

 

//////  variant parameters

DvnnRecord Record;     // 注意这里单位是弧度

 

};
```

 